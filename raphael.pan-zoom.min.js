/***
 * raphael.pan-zoom plugin 0.2.0
 * Copyright (c) 2012 @author Juan S. Escobar
 * https://github.com/escobar5
 *
 * licensed under the MIT license
 */
(function(){Raphael.fn.panzoom={};Raphael.fn.panzoom=function(e){var f=this;return new c(f,e)};var d={enable:function(){this.enabled=true},disable:function(){this.enabled=false},zoomIn:function(e){this.applyZoom(e)},zoomOut:function(e){this.applyZoom(e>0?e*-1:e)},pan:function(f,e){},isDragging:function(){return this.dragTime>this.dragThreshold},getCurrentPosition:function(){return this.currPos},getCurrentZoom:function(){return this.currZoom}},c=function(f,r){var g=f,e=g.canvas.parentNode,o=this,j={},h={x:0,y:0},l=0,k=0,p=(/Firefox/i.test(navigator.userAgent))?"DOMMouseScroll":"mousewheel";this.enabled=false;this.dragThreshold=5;this.dragTime=0;r=r||{};j.maxZoom=r.maxZoom||9;j.minZoom=r.minZoom||0;j.zoomStep=r.zoomStep||0.1;j.initialZoom=r.initialZoom||0;j.initialPosition=r.initialPosition||{x:0,y:0};this.currZoom=j.initialZoom;this.currPos=j.initialPosition;i();e.onmousedown=function(t){var s=window.event||t;if(!o.enabled){return false}o.dragTime=0;h=a(s,e);e.className+=" grabbing";e.onmousemove=q;document.onmousemove=function(){return false};if(s.preventDefault){s.preventDefault()}else{s.returnValue=false}return false};e.onmouseup=function(s){document.onmousemove=null;e.className=e.className.replace(/(?:^|\s)grabbing(?!\S)/g,"");e.onmousemove=null};if(e.attachEvent){e.attachEvent("on"+p,m)}else{if(e.addEventListener){e.addEventListener(p,m,false)}}function m(u){if(!o.enabled){return false}var s=window.event||u,v=s.detail?s.detail:s.wheelDelta*-1,t=a(s,e);if(v>0){v=-1}else{if(v<0){v=1}}n(v,t);if(s.preventDefault){s.preventDefault()}else{s.returnValue=false}return false}function n(s,t){if(!o.enabled){return false}o.currZoom+=s;if(o.currZoom<j.minZoom){o.currZoom=j.minZoom}else{if(o.currZoom>j.maxZoom){o.currZoom=j.maxZoom}else{t=t||{x:g.width/2,y:g.height/2};l=((g.width*j.zoomStep)*(t.x/g.width))*s;k=(g.height*j.zoomStep)*(t.y/g.height)*s;i()}}}this.applyZoom=n;function q(w){var u=window.event||w,v=g.width*(1-(o.currZoom*j.zoomStep)),t=g.height*(1-(o.currZoom*j.zoomStep)),s=a(u,e);l=(v*(s.x-h.x)/g.width)*-1;k=(t*(s.y-h.y)/g.height)*-1;h=s;i();o.dragTime++;if(u.preventDefault){u.preventDefault()}else{u.returnValue=false}return false}function i(){o.currPos.x=o.currPos.x+l;o.currPos.y=o.currPos.y+k;var t=g.width*(1-(o.currZoom*j.zoomStep)),s=g.height*(1-(o.currZoom*j.zoomStep));if(o.currPos.x<0){o.currPos.x=0}else{if(o.currPos.x>(g.width*o.currZoom*j.zoomStep)){o.currPos.x=(g.width*o.currZoom*j.zoomStep)}}if(o.currPos.y<0){o.currPos.y=0}else{if(o.currPos.y>(g.height*o.currZoom*j.zoomStep)){o.currPos.y=(g.height*o.currZoom*j.zoomStep)}}g.setViewBox(o.currPos.x,o.currPos.y,t,s)}};c.prototype=d;function a(h,g){var f,j,i;if(h.pageX||h.pageY){f=h.pageX;j=h.pageY}else{f=h.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;j=h.clientY+document.body.scrollTop+document.documentElement.scrollTop}i=b(g);f-=i[0];j-=i[1];return{x:f,y:j}}function b(e){var h=e.offsetLeft,f=e.offsetTop,g;while(e.offsetParent){if(e==document.getElementsByTagName("body")[0]){break}else{h=h+e.offsetParent.offsetLeft;f=f+e.offsetParent.offsetTop;e=e.offsetParent}}g=[h,f];return g}})();